/*! basket.js - v0.2.0 - 3/9/2012
* http://addyosmani.github.com/basket.js
* Copyright (c) 2012 Addy Osmani; Licensed MIT, GPL
* Credits: Addy Osmani, Ironsjp, Mathias Bynens, Rick Waldron, Sindre Sorhus, AndrÃ©e Hansson */
(function(a,b){"use strict";var c="basket-",d=[],e=0,f=0,g=[],h=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(){c.readyState===4&&b(c.responseText)},c.send()},i=function(a,b,c){h(a,function(a){localStorage.setItem(b,a),j(c)&&c()})},j=function(a){return Object.prototype.toString.call(a)==="[object Function]"},k=function(a){var c=b.createElement("script"),d=b.head||b.getElementsByTagName("head")[0];c.defer=!0,c.text=a,d.appendChild(c)},l=function(a){var b,c,f,h;if(e>=a)for(b=0;b<d.length;b++){f=d[b];if(!f)continue;d[b]=null,k(f),e++;for(c=b;c<e;c++)h=g[c],j(h)&&(g[c]=null,h())}};a.basket={require:function(a,b){b=b||{};var e=f,g=d.length,i=c+(b.key||a),j=localStorage.getItem(i);return d[g]=null,j?(d[g]=j,l(e)):h(a,function(a){localStorage.setItem(i,a),d[g]=a,l(e)}),this},add:function(a,b,d){b=b||{};var e=c+(b.key||a);return typeof b.overwrite=="undefined"&&(b.overwrite=!0),localStorage.getItem(e)?b.overwrite&&i(a,e,d):i(a,e,d),this},remove:function(a){return localStorage.removeItem(c+a),this},wait:function(a){return f=d.length-1,a&&(e>f?a():g[f]=a),this},get:function(a){return localStorage.getItem(c+a)||null}}})(this,document)
